{"ast":null,"code":"var _jsxFileName = \"/Users/hazukimiyake/Documents/matcha/src/InitialProfile/Photos/index.js\";\nimport React, { Component } from 'react';\nimport { withCookies } from 'react-cookie';\nimport Dropzone from 'react-dropzone';\nimport './index.css';\n\nconst {\n  imageData\n} = require('../../matcha_pb');\n\nclass InitialPhoto extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onDrop = async acceptedFile => {\n      const file = acceptedFile.find(f => f);\n\n      if (file) {\n        let joined = this.state.names.concat(file.name);\n        this.setState({\n          names: joined\n        });\n        let promise = new Promise((resolve, reject) => {\n          let reader = new FileReader();\n          reader.readAsDataURL(file);\n\n          reader.onload = () => {\n            resolve(reader.result);\n          };\n        });\n        const result = await promise;\n        const arr = result.split(\",\");\n        joined = this.state.images.concat(arr[1]);\n        this.setState({\n          images: joined\n        }); // this.props.history.push('../feed');\n      }\n    };\n\n    this.uploadPhotos = () => {\n      const request = new imageData();\n      const uid = this.props.cookies.get('uid');\n      const temp = this.props.cookies.get('session_id');\n      const metadata = {\n        'user_id': uid,\n        'session_id': temp\n      };\n      const length = this.state.images.length;\n\n      for (let i = 0; i < length; i++) {\n        request.setImage(this.state.images[i]);\n        request.setIndex(i + 1);\n        window.Aclient.updateImage(request, metadata, (err, reply) => {\n          if (err) {\n            console.log(err.code);\n            console.log(err.message);\n          } else {\n            console.log(reply.getMessage());\n          }\n        });\n      }\n    };\n\n    this.state = {\n      names: [],\n      images: []\n    };\n  }\n\n  render() {\n    const maxSize = 5242880;\n    const images = this.state.images;\n\n    const Example = ({\n      data\n    }) => React.createElement(\"img\", {\n      src: `data:image/jpeg;base64, ${data}`,\n      alt: \"\",\n      width: \"300\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    });\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, React.createElement(Dropzone, {\n      onDrop: this.onDrop,\n      accept: \"image/png, image/jpeg, image/jpg\",\n      minSize: 0,\n      maxSize: maxSize,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }, ({\n      getRootProps,\n      getInputProps,\n      isDragActive,\n      isDragReject,\n      rejectedFiles\n    }) => {\n      const isFileTooLarge = rejectedFiles.length > 0 && rejectedFiles[0].size > maxSize;\n      return React.createElement(\"div\", Object.assign({}, getRootProps(), {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }), React.createElement(\"input\", Object.assign({}, getInputProps(), {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      })), !isDragActive && 'Click here or drop a file to upload!', isDragActive && !isDragReject && \"Drop it like it's hot!\", isDragReject && \"File type not accepted, sorry!\", isFileTooLarge && React.createElement(\"div\", {\n        className: \"text-danger mt-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }, \"File is too large.\"));\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, images.map((image, key) => React.createElement(Example, {\n      data: image,\n      key: key,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }))), React.createElement(\"button\", {\n      type: \"submit\",\n      onClick: this.uploadPhotos,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, \"Start Exploring\"));\n  }\n\n}\n\nexport default withCookies(InitialPhoto);","map":{"version":3,"sources":["/Users/hazukimiyake/Documents/matcha/src/InitialProfile/Photos/index.js"],"names":["React","Component","withCookies","Dropzone","imageData","require","InitialPhoto","constructor","props","onDrop","acceptedFile","file","find","f","joined","state","names","concat","name","setState","promise","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","arr","split","images","uploadPhotos","request","uid","cookies","get","temp","metadata","length","i","setImage","setIndex","window","Aclient","updateImage","err","reply","console","log","code","message","getMessage","render","maxSize","Example","data","getRootProps","getInputProps","isDragActive","isDragReject","rejectedFiles","isFileTooLarge","size","map","image","key"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { withCookies } from 'react-cookie';\nimport Dropzone from 'react-dropzone';\nimport './index.css';\nconst { imageData } = require('../../matcha_pb');\n\nclass InitialPhoto extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tnames: [],\n\t\t\timages: []\n\t\t}\n\t}\n\n\tonDrop = async (acceptedFile) => {\n\t\tconst file = acceptedFile.find(f => f)\n\t\tif (file) {\n\t\t\tlet joined = this.state.names.concat(file.name);\n\t\t\tthis.setState({ names: joined });\n\t\t\tlet promise = new Promise((resolve, reject) => {\n\t\t\t\tlet reader = new FileReader()\n\t\t\t\treader.readAsDataURL(file)\n\t\t\t\treader.onload = () => {\n\t\t\t\t\tresolve(reader.result);\n\t\t\t\t}\n\t\t\t})\n\t\t\tconst result = await promise;\n\t\t\tconst arr = result.split(\",\");\n\t\t\tjoined = this.state.images.concat(arr[1]);\n\t\t\tthis.setState({ images: joined });\n\t\t\t// this.props.history.push('../feed');\n\t\t}\n\t}\n\n\tuploadPhotos = () => {\n\t\tconst request = new imageData();\n\t\tconst uid = this.props.cookies.get('uid');\n\t\tconst temp = this.props.cookies.get('session_id');\n\t\tconst metadata = {\n\t\t\t'user_id': uid,\n\t\t\t'session_id': temp\n\t\t}\n\t\tconst length = this.state.images.length;\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\trequest.setImage(this.state.images[i]);\n\t\t\trequest.setIndex(i + 1);\n\t\t\twindow.Aclient.updateImage(request, metadata, (err, reply) => {\n\t\t\t\tif (err) {\n\t\t\t\t\tconsole.log(err.code);\n\t\t\t\t\tconsole.log(err.message);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log(reply.getMessage());\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\trender() {\n\t\tconst maxSize = 5242880;\n\t\tconst images = this.state.images;\n\t\tconst Example = ({ data }) => <img src={`data:image/jpeg;base64, ${data}`} alt=\"\" width=\"300\" />\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Dropzone\n\t\t\t\t\tonDrop={this.onDrop}\n\t\t\t\t\taccept=\"image/png, image/jpeg, image/jpg\"\n\t\t\t\t\tminSize={0}\n\t\t\t\t\tmaxSize={maxSize}\n\t\t\t\t>\n\t\t\t\t\t{({getRootProps, getInputProps, isDragActive, isDragReject, rejectedFiles}) => {\n\t\t\t\t\t\tconst isFileTooLarge = rejectedFiles.length > 0 && rejectedFiles[0].size > maxSize;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div {...getRootProps()}>\n\t\t\t\t\t\t\t\t<input {...getInputProps()} />\n\t\t\t\t\t\t\t\t{!isDragActive && 'Click here or drop a file to upload!'}\n\t\t\t\t\t\t\t\t{isDragActive && !isDragReject && \"Drop it like it's hot!\"}\n\t\t\t\t\t\t\t\t{isDragReject && \"File type not accepted, sorry!\"}\n\t\t\t\t\t\t\t\t{isFileTooLarge && (\n\t\t\t\t\t\t\t\t\t<div className=\"text-danger mt-2\">\n\t\t\t\t\t\t\t\t\t\tFile is too large.\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t}\n\t\t\t\t</Dropzone>\n\t\t\t\t<div>\n\t\t\t\t\t{images.map((image, key) => <Example data={image} key={key}/>)}\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\tonClick={this.uploadPhotos}\n\t\t\t\t>\n\t\t\t\t\tStart Exploring\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default withCookies(InitialPhoto);"]},"metadata":{},"sourceType":"module"}